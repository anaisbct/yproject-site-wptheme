function WDGCampaignSimulator(){this.calculAndShowResult(),this.attachEventOnCa(),$("#form-changing-from-vote").submit(function(e){confirm("Attention, le choix de la date de fin est définitif. Êtes-vous sûr(e) de valider cette date de fin ?")||e.preventDefault()})}function WDGCampaignDashboard(){this.walletTimetableDatatable,this.createTableRequest,this.initWithHash(),this.initLinks(),this.initMenu(),this.initStatsSubTabs(),this.drawTimetable(),this.initAjaxForms(),this.initHome(),this.initContacts(),this.initOrgaForms(),this.initTeam(),this.initRoyalties(),this.initFinance(),this.initCampaign()}function addCheckByPMCallback(e){if($("form#form-contacts-add-check p.errors").remove(),""!=e)try{var a=JSON.parse(e),t=a.errors,i=0;for(var n in t)if(""!==n){i++;$("<p class='errors'>"+t[n][1]+"</p>").insertBefore($("form#form-contacts-add-check div#field-"+t[n][0]+" .field-container"))}if(i>0){var o=$("form#form-contacts-add-check").find(".errors").first().parent();1===o.length&&wdgCampaignDashboard.scrollTo(o)}else"1"===a.success&&($("form#form-contacts-add-check .loading").show(),$("form#form-contacts-add-check button").hide(),window.location.reload())}catch(e){}}WDGCampaignSimulator.prototype.createCaTab=function(){if("0"!==new_funding_duration){for(var e=parseInt(new_funding_duration),a=new Array,t=0;t<e;t++){var i=null==$("#new_estimated_turnover_"+t).val()?$.trim($("td[data-id=new_estimated_turnover_"+t+"]").text()):$("#new_estimated_turnover_"+t).val();a.push(parseFloat(i))}return a}},WDGCampaignSimulator.prototype.calculTotalCa=function(){caTab=this.createCaTab(),totalca=0,$.each(caTab,function(e,a){a>=0&&(totalca+=a)})},WDGCampaignSimulator.prototype.calculRoiPerYear=function(){""!==new_roi_percent_estimated?percent=parseFloat(new_roi_percent_estimated)/100:percent=!1;for(var e=0;e<caTab.length;e++)if(caTab[e]>0)if(percent){var a=percent*caTab[e],t=this.numberFormat(a);$("#roi-amount-"+e).html(t+" "+$("#estimated-turnover").data("symbol"))}else $("#roi-amount-"+e).html("0 "+$("#estimated-turnover").data("symbol"));else $("#roi-amount-"+e).html("0 "+$("#estimated-turnover").data("symbol"))},WDGCampaignSimulator.prototype.calculReturn=function(){if(totalRoi=0,percent&&(totalRoi=percent*totalca,totalRoi)){var e=this.numberFormat(totalRoi);$("#total-roi").html(e+" "+$("#estimated-turnover").data("symbol"))}},WDGCampaignSimulator.prototype.calculCollect=function(){if(""!==need){collect=need;var e=this.numberFormat(collect);$("#total-funding").html(e)}},WDGCampaignSimulator.prototype.calculAnnualRend=function(){for(var e=0,a=0;a<caTab.length;a++)caTab[a]>0&&e++;if(finalRend=null,"0"!=collect&&0!=e){finalRend=Math.round(100*(totalRoi/need-1)*100)/100;var t=this.numberFormat(finalRend);finalRend>0&&(t="+"+t),$("#medium-rend").html(t+" %")}else"0"!=collect&&0!=e||this.initResultCalcul()},WDGCampaignSimulator.prototype.verifMediumRend=function(){var e=$("#medium-rend");finalRend<0?(e.css("color","#EA4F51").css("display","inline-block").css("margin",0),e.append("<br/>(insuffisant)")):e.css("color","#2B2C2C")},WDGCampaignSimulator.prototype.calculGain=function(){if(""!=need&&"0"!=need&&""!=new_roi_percent_estimated&&"0"!=new_roi_percent_estimated){var e=totalRoi/need,a="x"+this.numberFormat(e)+" en "+nb_years+" ans";$("#gain").html(a)}else $("#gain").html("")},WDGCampaignSimulator.prototype.simuProcess=function(){this.calculTotalCa(),this.calculRoiPerYear(),this.calculReturn(),this.calculCollect(),this.calculAnnualRend(),this.verifMediumRend(),this.calculGain()},WDGCampaignSimulator.prototype.initResultCalcul=function(){$("#total-roi").html("0 "+$("#estimated-turnover").data("symbol")),$("#total-funding").html("---"),$("#medium-rend").html("--- %").css("color","#2B2C2C"),$("#gain").html(""),caTab=this.createCaTab();for(var e=0;e<caTab.length;e++)$("#roi-amount-"+e).html("0 "+$("#estimated-turnover").data("symbol"))},WDGCampaignSimulator.prototype.calculAndShowResult=function(){this.getDataCalculator(),""!=new_minimum_goal&&""!=need&&""!=new_funding_duration&&""!=new_roi_percent_estimated&&""!=new_estimated_turnover_0?this.simuProcess():this.initResultCalcul()},WDGCampaignSimulator.prototype.getDataCalculator=function(){new_minimum_goal=null==$("#new_minimum_goal").val()?$.trim($("span[data-id=new_minimum_goal] span").text()):$("#new_minimum_goal").val(),need=null==$("#new_maximum_goal").val()?$.trim($("span[data-id=new_maximum_goal] span").text()):$("#new_maximum_goal").val(),new_roi_percent_estimated=null==$("#new_roi_percent_estimated").val()?$.trim($("span[data-id=new_roi_percent_estimated] span").text()):$("#new_roi_percent_estimated").val(),new_funding_duration=null==$("#select-new_funding_duration").val()?$.trim($("span[data-id=new_funding_duration] span").text()):$("#select-new_funding_duration").val(),0==new_funding_duration&&(new_funding_duration=5),nb_years=new_funding_duration,new_estimated_turnover_0=null==$("#new_estimated_turnover_0").val()?$.trim($("td[data-id=new_estimated_turnover_0]").text()):$("#new_estimated_turnover_0").val()},WDGCampaignSimulator.prototype.attachEventOnCa=function(){for(var e=this,a=0;a<parseInt(new_funding_duration);a++){var t=null==$("#new_estimated_turnover_"+a).val()?$("td[data-id=new_estimated_turnover_"+a+"]"):$("#new_estimated_turnover_"+a);$(t).bind("click keyup",function(){e.calculAndShowResult()})}},WDGCampaignSimulator.prototype.numberFormat=function(e){var a=e.toString().replace(",",".");return a=parseFloat(a),"00"===(a=a.toFixed(2)).substr(a.length-2,a.length)&&(a=a.substr(0,a.length-3)),a};var wdgCampaignSimulator;jQuery(document).ready(function(e){wdgCampaignSimulator=new WDGCampaignSimulator}),WDGCampaignDashboard.prototype.initWithHash=function(){var e=window.location.hash.substring(1);""!==e?this.switchTab(e):this.switchTab("home")},WDGCampaignDashboard.prototype.initLinks=function(){var e=this;$("a").click(function(){void 0!==$(this).attr("href")&&""!==$(this).attr("href")&&-1===$(this).attr("href").indexOf("#")&&(void 0!==e.createTableRequest&&e.createTableRequest.abort(),""!==YPUIFunctions.currentRequest&&YPUIFunctions.currentRequest.abort())})},WDGCampaignDashboard.prototype.initMenu=function(){var e=this;$("ul.nav-menu li a").each(function(){$(this).click(function(){e.switchTab($(this).data("tab"))})}),$("a.switch-tab").click(function(){e.switchTab($(this).attr("href").substr(1))})},WDGCampaignDashboard.prototype.initStatsSubTabs=function(){$("ul.menu-onglet li a").each(function(){$(this).click(function(){""!==$(this).data("subtab")&&($(".stat-subtab").hide(),$("#stat-subtab-"+$(this).data("subtab")).show(),$("ul.menu-onglet li a").removeClass("focus"),$(this).addClass("focus"),"leveedefonds"==$(this).data("subtab")&&$("#sup-stats-chart").width(600))})})},WDGCampaignDashboard.prototype.switchTab=function(e){$("ul.nav-menu li").removeClass("selected"),$("div#item-body > div.item-body-tab").hide(),$("ul.nav-menu li#menu-item-"+e).addClass("selected"),$("div#item-body > div#item-body-"+e).show(),"royalties"==e&&void 0!=this.walletTimetableDatatable&&this.walletTimetableDatatable.draw(),"contacts"==e&&void 0!=this.table&&this.table.draw(),this.scrollTo($("#item-body"))},WDGCampaignDashboard.prototype.initAjaxForms=function(){var e=this;$("form.ajax-db-form").submit(function(a){if(""==$(this).attr("action")||void 0==$(this).attr("action")){if(a.preventDefault(),void 0==$(this).data("action"))return!1;var t=$(this),i={action:$(this).data("action"),campaign_id:campaign_id};$(this).find(".field").each(function(e){var a=$(this).data("id");if(void 0!=a){switch($(this).data("type")){case"datetime":var t=$(this).find("input:eq(0)").val().split("/");i[a]=t[1]+"/"+t[0]+"/"+t[2]+" "+$(this).find("select:eq(0)").val()+":"+$(this).find("select:eq(1)").val();break;case"editor":i[a]=tinyMCE.get(a).getContent();break;case"check":i[a]=$("#"+a).is(":checked");break;case"multicheck":var n=new Array;$("input",this).each(function(){$(this).is(":visible")&&$(this).is(":checked")&&n.push($(this).val())}),i[a]=n;break;case"checkboxes":$("input",this).each(function(){$(this).is(":checked")&&(i[a]=$(this).is(":checked"))});break;case"text":case"number":case"date":case"link":case"textarea":case"select":default:i[a]=$(":input",this).val()}void 0==i[a]&&delete i[a]}});var n=$("#"+$(this).attr("id")+"_button");n.find(".button-text").hide(),n.find(".button-waiting").show(),$(":input",this).prop("disabled",!0),t.find(".feedback_save span").fadeOut(),$.ajax({type:"POST",url:ajax_object.ajax_url,data:i}).done(function(a){if(""!=a){var i=JSON.parse(a);feedback=i;for(var n in feedback.errors)e.fieldError(t.find("#"+n),feedback.errors[n]);for(var n in feedback.success){var o=t.find("#"+n);0==o.length&&(o=t.find("input[name="+n+"],select[name="+n+"]")),e.removeFieldError(o),o.closest(".field-value").parent().find("i.fa.validation").remove(),o.addClass("validation"),o.closest(".field-value").after('<i class="fa fa-check validation" aria-hidden="true"></i>')}var r=t.find(".error").first();1==r.length?(e.scrollTo(r),r.focus(),t.find(".save_errors").fadeIn()):t.find(".save_ok").fadeIn(),"save_project_organization"==$(this).data("action")&&(e.updateEditOrgaBtn(t),e.updateOrgaForm(feedback),e.updateOrgaFormDoc(feedback),$("#save-mention").hide(),$("#orgainfo_form_button").hide(),t.find(".save_ok").hide(),$("#wdg-lightbox-valid-changeOrga").css("display","block"),new_project_organization=$("#select-new_project_organization option:selected").val())}}).fail(function(){t.find(".save_fail").fadeIn()}).always(function(){n.find(".button-waiting").hide(),n.find(".button-text").show(),t.find(":input").prop("disabled",!1)})}})},WDGCampaignDashboard.prototype.initHome=function(){($("#innbdayvote").length>0||$("#innbdaycollecte").length>0)&&(updateDate=function(e,a){if($("#"+a).empty(),$("#"+e).val()<=$("#"+e).prop("max")&&$("#"+e).val()>=$("#"+e).prop("min")){var t=new Date,i=$("#"+e).val();t.setDate(t.getDate()+parseInt(i)),$("#"+a).prepend(" "+t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear())}else $("#"+a).prepend("La durée doit être comprise entre "+$("#"+e).prop("min")+" et "+$("#"+e).prop("max")+" jours")},updateDate("innbdaycollecte","previewenddatecollecte"),updateDate("innbdayvote","previewenddatevote"),$("#innbdaycollecte").on("keyup change",function(){updateDate("innbdaycollecte","previewenddatecollecte")}),$("#innbdayvote").on("keyup change",function(){updateDate("innbdayvote","previewenddatevote")}))},WDGCampaignDashboard.prototype.initContacts=function(){var e,a,t,i=this;if($("#direct-mail #mail-preview-button").click(function(){e=tinyMCE.get("mail_content").getContent(),""==(a=$("#direct-mail #mail-title").val())?i.fieldError($("#direct-mail #mail-title"),"L'objet du mail ne peut être vide"):(i.removeFieldError($("#direct-mail #mail-title")),t=$(this).html(),$(this).html('<i class="fa fa-spinner fa-spin fa-1x fa-fw"></i>'),$.ajax({type:"POST",url:ajax_object.ajax_url,data:{action:"preview_mail_message",id_campaign:campaign_id,mail_content:e,mail_title:a}}).done(function(e){var a=JSON.parse(e);$("#direct-mail .preview-title").html('<i class="fa fa-envelope" aria-hidden="true"></i>&nbsp;'+a.content.title),$("#direct-mail .preview").html(a.content.body),$("#direct-mail .step-write").slideUp(),$("#direct-mail .step-confirm").slideDown(),$("#direct-mail #mail-preview-button").html(t)}))}),$("#direct-mail #mail-back-button").click(function(){$("#direct-mail .step-confirm").slideUp(),$("#direct-mail .step-write").slideDown()}),$(".show-notifications").click(function(e){e.preventDefault(),$("#form-notifications #mail_type").val($(this).data("mailtype")),$("#form-notifications").hide(),$("#form-notifications").slideDown(100)}),$(".button-contacts-add-check").length>0){$(".button-contacts-add-check").click(function(){$("#form-contacts-add-check").slideDown(30),i.scrollTo($("#form-contacts-add-check"))});var n=new Array;$("#button-contacts-add-check-search").click(function(e){e.preventDefault(),$("#button-contacts-add-check-search").addClass("disabled"),$(".add-check-feedback").hide(),$("#fields-user-info").hide(),$("#fields-orga-info").hide(),$("#fields-orga-select").hide(),$("#fields-save-info").hide(),$("#add-check-search-loading").show(),$.ajax({type:"POST",url:ajax_object.ajax_url,data:{action:"search_user_by_email",email:$("#form-contacts-add-check #user-email").val()}}).done(function(e){$("#button-contacts-add-check-search").removeClass("disabled"),$("#add-check-search-loading").hide();var a=JSON.parse(e);switch(a.user_type){case"user":$("#add-check-feedback-found-orga").hide(),$("#add-check-feedback-found-user").show(),$("#fields-user-info").show(),$("#fields-user-info #select-gender").val(a.user_data.user.gender),$("#fields-user-info #firstname").val(a.user_data.user.firstname),$("#fields-user-info #lastname").val(a.user_data.user.lastname),$("#fields-user-info #field-birthday .adddatepicker").datepicker("setDate",a.user_data.user.birthday_day+"/"+a.user_data.user.birthday_month+"/"+a.user_data.user.birthday_year),$("#fields-user-info #birthplace").val(a.user_data.user.birthplace),$("#fields-user-info #select-birthplace_department").val(a.user_data.user.birthplace_department),$("#fields-user-info #select-birthplace_district").val(a.user_data.user.birthplace_district),$("#fields-user-info #select-birthplace_country").val(a.user_data.user.birthplace_country),$("#fields-user-info #select-nationality").val(a.user_data.user.nationality),$("#fields-user-info #address_number").val(a.user_data.user.address_number),$("#fields-user-info #select-address_number_complement").val(a.user_data.user.address_number_complement),$("#fields-user-info #address").val(a.user_data.user.address),$("#fields-user-info #postal_code").val(a.user_data.user.postal_code),$("#fields-user-info #city").val(a.user_data.user.city),$("#fields-user-info #select-country").val(a.user_data.user.country),$("form#form-contacts-add-check select#select-orga_id option").each(function(){""!==$(this).val()&&"new-orga"!==$(this).val()&&$(this).remove()}),n=new Array;for(var t=a.user_data.orga_list,i=a.user_data.orga_list.length,o=0;o<i;o++)$("form#form-contacts-add-check select#select-orga_id").append('<option value="'+t[o].wpref+'">'+t[o].name+"</option>"),n[t[o].wpref]=t[o];break;case"orga":$("#add-check-feedback-found-user").hide(),$("#fields-user-info").hide(),$("#add-check-feedback-found-orga").show();break;default:$("#add-check-feedback-found-orga").hide(),$("#add-check-feedback-not-found").show(),$("#fields-user-info").show(),$("#fields-user-info #select-gender").val(""),$("#fields-user-info #firstname").val(""),$("#fields-user-info #lastname").val(""),$("#fields-user-info #field-birthday .adddatepicker").datepicker("setDate","01/01/1970"),$("#fields-user-info #birthplace").val(""),$("#fields-user-info #select-nationality").val(""),$("#fields-user-info #address_number").val(""),$("#fields-user-info #select-address_number_complement").val(""),$("#fields-user-info #address").val(""),$("#fields-user-info #postal_code").val(""),$("#fields-user-info #city").val(""),$("#fields-user-info #select-country").val("")}})}),$("form#form-contacts-add-check select#select-user_type").change(function(){""!=$("form#form-contacts-add-check select#select-user_type").val()?"user"!=$("form#form-contacts-add-check select#select-user_type").val()?($("#fields-save-info").hide(),$("#fields-orga-select").show()):($("#fields-orga-select").hide(),$("#fields-save-info").show()):($("#fields-orga-select").hide(),$("#fields-save-info").hide()),$("#fields-orga-info").hide()}),$("form#form-contacts-add-check select#select-orga_id").change(function(){if(""!=$("form#form-contacts-add-check select#select-orga_id").val()){if("new-orga"==$("form#form-contacts-add-check select#select-orga_id").val())$("#fields-orga-info #org_name").val(""),$("#fields-orga-info #org_email").val(""),$("#fields-orga-info #org_website").val(""),$("#fields-orga-info #org_legalform").val(""),$("#fields-orga-info #org_idnumber").val(""),$("#fields-orga-info #org_rcs").val(""),$("#fields-orga-info #org_capital").val(""),$("#fields-orga-info #org_address_number").val(""),$("#fields-orga-info #select-org_address_number_comp").val(""),$("#fields-orga-info #org_address").val(""),$("#fields-orga-info #org_postal_code").val(""),$("#fields-orga-info #org_city").val(""),$("#fields-orga-info #select-org_nationality").val("");else{var e=n[$("form#form-contacts-add-check select#select-orga_id").val()];$("#fields-orga-info #org_name").val(e.name),$("#fields-orga-info #org_email").val(e.email),$("#fields-orga-info #org_website").val(e.website),$("#fields-orga-info #org_legalform").val(e.legalform),$("#fields-orga-info #org_idnumber").val(e.idnumber),$("#fields-orga-info #org_rcs").val(e.rcs),$("#fields-orga-info #org_capital").val(e.capital),$("#fields-orga-info #org_address_number").val(e.address_number),$("#fields-orga-info #select-org_address_number_comp").val(e.address_number_comp),$("#fields-orga-info #org_address").val(e.address),$("#fields-orga-info #org_postal_code").val(e.postal_code),$("#fields-orga-info #org_city").val(e.city),$("#fields-orga-info #select-org_nationality").val(e.nationality)}$("#fields-orga-info").show(),$("#fields-save-info").show()}else $("#fields-orga-info").hide(),$("#fields-save-info").hide()})}$("div#investment-drafts-list").length>0&&($("button.btn-view-investment-draft").click(function(){var e=$(this).data("draftid");$("form#preview-investment-draft-"+e).toggle()}),$("button.apply-draft-data").click(function(){var e=$(this).parent().data("userid"),a=$(this).parent().data("orgaid"),t=$(this).parent().data("draftid"),i=$(this).data("type"),n=$(this).data("value");$(this).hide(),"all"===i&&$("#preview-investment-draft-"+t+" button.apply-draft-data").hide(),$("#preview-investment-draft-"+t+" #img-loading-data-"+i).show(),$.ajax({type:"POST",url:ajax_object.ajax_url,data:{action:"apply_draft_data",user_id:e,orga_id:a,draft_id:t,data_type:i,data_value:n}}).done(function(e){$('<i class="text-green">'+e+"</i>").insertAfter($("#preview-investment-draft-"+t+" #img-loading-data-"+i)),$("#preview-investment-draft-"+t+" #img-loading-data-"+i).hide()})}),$("button.create-investment-from-draft").click(function(){var e=$(this).parent().data("draftid"),a=$(this).parent().data("campaignid");$(this).hide(),$("#preview-investment-draft-"+e+" #img-loading-create-investment").show(),$.ajax({type:"POST",url:ajax_object.ajax_url,data:{action:"create_investment_from_draft",draft_id:e,campaign_id:a}}).always(function(e){window.location.reload()})}))},WDGCampaignDashboard.prototype.initOrgaForms=function(){var e=this;if($("#orgainfo_form_button").hide(),""!==$("#select-new_project_organization").val()){var a=$("#select-new_project_organization option:selected").val();$("#edit-orga-button").show()}$("#select-new_project_organization").change(function(e){e.preventDefault(),$("#orgainfo_form_button").hide(),$("#select-new_project_organization option:selected").val()!==a?($("#edit-orga-button").hide(),$("#orgainfo_form_button").show(),$(".save_ok").length>0&&$(".save_ok").hide(),$("#orgainfo_form i.fa.validation").length>0&&$("#orgainfo_form i.fa.validation").remove(),$("#select-new_project_organization").hasClass("validation")&&$("#select-new_project_organization").removeClass("validation"),$("#save-mention").is(":hidden")&&$("#save-mention").show()):($("#save-mention").is(":visible")&&$("#save-mention").hide(),$("#edit-orga-button").show()),$("#wdg-lightbox-editOrga ul.errors li").remove()}),$("#orgainfo_form #edit-orga-button").click(function(){$("#orgaedit_form").find(".save_ok").fadeOut()}),$("#wdg-lightbox-editOrga form#orgaedit_form").submit(function(a){a.preventDefault();var t=$(this),i=new FormData($("#wdg-lightbox-editOrga #orgaedit_form")[0]),n=$("#"+$(this).attr("id")+"_button");n.find(".button-text").hide(),n.find(".button-waiting").show(),$(":input",this).prop("disabled",!0),t.find(".feedback_save span").fadeOut(),$.ajax({type:"POST",url:ajax_object.ajax_url,data:i,cache:!1,contentType:!1,processData:!1}).done(function(a){if("FALSE"===a)window.location.reload();else{var i=JSON.parse(a);feedback=i,$("#wdg-lightbox-editOrga p.errors").remove();var n=feedback.files_info,o=0;for(var r in n)if(null!=n[r])if(1===n[r].code){o+=1;$('<p class="errors">'+n[r].info+"</p>").insertAfter($("#orgaedit_form input[name="+r+"]"))}else e.updateOrgaDoc(n,r);var d=feedback.errors,s=0;for(var l in d)if(""!==l){s+=1;(c=$("<p class='errors'>"+d[l]+"</p>")).insertAfter($("#orgaedit_form input[name="+l+"]"))}if(o>0||s>0){var c=$("<p class='errors'>Certains champs n'ont pas été validés.</p>");c.insertAfter($("#orgaedit_form_button button"))}0===o&&0===s&&($("#wdg-lightbox-editOrga p.errors").hide(),t.find(".save_ok").fadeIn(),$("#wdg-lightbox-editOrga").hide(),$("#wdg-lightbox-valid-editOrga").css("display","block"),e.updateOrgaForm(feedback))}}).fail(function(){t.find(".save_fail").fadeIn()}).always(function(){n.find(".button-waiting").hide(),n.find(".button-text").show(),t.find(":input").prop("disabled",!1)})}),$("#orgainfo_form #btn-new-orga").click(function(){$(":input","#orgacreate_form").not(":hidden").val("").removeAttr("checked").removeAttr("selected"),$("#orgacreate_form").find(".save_ok").fadeOut(),$("#wdg-lightbox-newOrga p.errors").remove()}),$("#wdg-lightbox-newOrga form.wdg-forms").submit(function(a){a.preventDefault();var t,i,n,o,r,d,s,l,c,u,g,f,m,_,p,h,b,v,w,x,y,k,O,D=$(this);t=$("#wdg-lightbox-newOrga input[name=campaign_id]").val(),i=$("#wdg-lightbox-newOrga input[name=org_name]").val(),n=$("#wdg-lightbox-newOrga input[name=org_email]").val(),o=$("#wdg-lightbox-newOrga input[name=org_representative_function]").val(),r=$("#wdg-lightbox-newOrga input[name=org_description]").val(),d=$("#wdg-lightbox-newOrga input[name=org_legalform]").val(),s=$("#wdg-lightbox-newOrga input[name=org_idnumber]").val(),l=$("#wdg-lightbox-newOrga input[name=org_rcs]").val(),c=$("#wdg-lightbox-newOrga input[name=org_capital]").val(),u=$("#wdg-lightbox-newOrga input[name=org_ape]").val(),g=$("#wdg-lightbox-newOrga input[name=org_vat]").val(),f=$("#wdg-lightbox-newOrga select[name=org_fiscal_year_end_month]").val(),m=$("#wdg-lightbox-newOrga input[name=org_address_number]").val(),_=$("#wdg-lightbox-newOrga input[name=org_address_number_comp]").val(),p=$("#wdg-lightbox-newOrga input[name=org_address]").val(),h=$("#wdg-lightbox-newOrga input[name=org_postal_code]").val(),b=$("#wdg-lightbox-newOrga input[name=org_city]").val(),v=$("#wdg-lightbox-newOrga #org_nationality option:selected").text(),w=$("#wdg-lightbox-newOrga input[name=org_bankownername]").val(),x=$("#wdg-lightbox-newOrga input[name=org_bankowneraddress]").val(),y=$("#wdg-lightbox-newOrga input[name=org_bankowneriban]").val(),k=$("#wdg-lightbox-newOrga input[name=org_bankownerbic]").val(),O=$("#wdg-lightbox-newOrga input[name=org_capable]").is(":checked");var C=$("#"+$(this).attr("id")+"_button");C.find(".button-text").hide(),C.find(".button-waiting").show(),$(":input",this).prop("disabled",!0),D.find(".feedback_save span").fadeOut(),$.ajax({type:"POST",url:ajax_object.ajax_url,data:{action:"save_new_organization",campaign_id:t,org_name:i,org_email:n,org_representative_function:o,org_description:r,org_legalform:d,org_idnumber:s,org_rcs:l,org_capital:c,org_ape:u,org_vat:g,org_fiscal_year_end_month:f,org_address_number:m,org_address_number_comp:_,org_address:p,org_postal_code:h,org_city:b,org_nationality:v,org_bankownername:w,org_bankowneraddress:x,org_bankowneriban:y,org_bankownerbic:k,org_capable:O}}).done(function(a){if("FALSE"===a)window.location.reload();else{var t=JSON.parse(a);feedback=t,$("#wdg-lightbox-newOrga p.errors").remove();var i=feedback.errors,n=0;for(var o in i)if(""!==o){n+=1;var r=$('<p class="errors">'+i[o]+"</p>");"org_capable"!==o&&r.insertAfter($("#orgacreate_form input[name="+o+"]")),"org_nationality"===o&&r.insertAfter($("#orgacreate_form select#org_nationality")),"org_capable"===o&&r.insertAfter($("#orgacreate_form input[name="+o+"]").next())}if(n>0){var d=D.find(".errors").first();1===d.length&&e.scrollTo(d)}if(0===n){$("#wdg-lightbox-newOrga p.errors").hide(),D.find(".save_ok").fadeIn(),$("#wdg-lightbox-newOrga").hide(),$("#wdg-lightbox-valid-newOrga").css("display","block"),e.updateOrgaSelectInput(feedback);var s=$("#select-new_project_organization").find("option:selected").text(),l=$("#orgainfo_form").find($("#edit-orga-button"));l.attr("href","#"),l.text("Editer "+s),e.updateOrgaForm(feedback)}}}).fail(function(){D.find(".save_fail").fadeIn()}).always(function(){C.find(".button-waiting").hide(),C.find(".button-text").show(),D.find(":input").prop("disabled",!1)})}),$("#update_project_organization").change(function(e){var a=$("#update_project_organization").val();if(""!=a){$("#edit-orga-button").show();$("#update_project_organization").find("option:selected").text();$("#edit-orga-button").attr("href",$("#edit-orga-button").data("url-edit")+a)}})},WDGCampaignDashboard.prototype.updateEditOrgaBtn=function(e){if(""!==$("#select-new_project_organization").val()){var a=e.find($("#edit-orga-button")).show(),t=$("#select-new_project_organization").find("option:selected").text();a.attr("href","#"),a.text("Editer "+t)}else a.hide()},WDGCampaignDashboard.prototype.updateOrgaForm=function(e){$("#wdg-lightbox-editOrga #org_name").length>0?$("#wdg-lightbox-editOrga #org_name").html(e.organization.name):$("#wdg-lightbox-editOrga input[name=org_name]").val(e.organization.name),$("#wdg-lightbox-editOrga input[name=org_email]").val(e.organization.email),$("#wdg-lightbox-editOrga input[name=org_representative_function]").val(e.organization.representative_function),$("#wdg-lightbox-editOrga input[name=org_description]").val(e.organization.description),$("#wdg-lightbox-editOrga input[name=org_legalform]").val(e.organization.legalForm),$("#wdg-lightbox-editOrga input[name=org_idnumber]").val(e.organization.idNumber),$("#wdg-lightbox-editOrga input[name=org_rcs]").val(e.organization.rcs),$("#wdg-lightbox-editOrga input[name=org_capital]").val(e.organization.capital),$("#wdg-lightbox-editOrga input[name=org_ape]").val(e.organization.ape),$("#wdg-lightbox-editOrga input[name=org_vat]").val(e.organization.vat),$("#wdg-lightbox-editOrga input[name=org_fiscal_year_end_month]").val(e.organization.fiscal_year_end_month),$("#wdg-lightbox-editOrga input[name=org_address_number]").val(e.organization.address_number),$("#wdg-lightbox-editOrga input[name=org_address_number_comp]").val(e.organization.address_number_comp),$("#wdg-lightbox-editOrga input[name=org_address]").val(e.organization.address),$("#wdg-lightbox-editOrga input[name=org_postal_code]").val(e.organization.postal_code),$("#wdg-lightbox-editOrga input[name=org_city]").val(e.organization.city),$("#wdg-lightbox-editOrga input[name=org_nationality]").val(e.organization.nationality),$("#wdg-lightbox-editOrga input[name=org_bankownername]").val(e.organization.bankownername),$("#wdg-lightbox-editOrga input[name=org_bankowneraddress]").val(e.organization.bankowneraddress),$("#wdg-lightbox-editOrga input[name=org_bankowneriban]").val(e.organization.bankowneriban),$("#wdg-lightbox-editOrga input[name=org_bankownerbic]").val(e.organization.bankownerbic)},WDGCampaignDashboard.prototype.updateOrgaFormDoc=function(e){if(null!=e.organization.doc_bank.path)if(0===$("#wdg-lightbox-editOrga a#org_doc_bank").length){$('<a id="org_doc_bank" class="button blue-pale download-file" target="_blank" href="'+e.organization.doc_bank.path+'">'+e.organization.doc_bank.date_uploaded+"</a><br />").insertBefore($("#wdg-lightbox-editOrga input[name=org_doc_bank]"))}else $("#wdg-lightbox-editOrga a#org_doc_bank").attr("href",e.organization.doc_bank.path),$("#wdg-lightbox-editOrga a#org_doc_bank").html(e.organization.doc_bank.date_uploaded);else $("#wdg-lightbox-editOrga a#org_doc_bank").remove();if(null!=e.organization.doc_kbis.path)if(0===$("#wdg-lightbox-editOrga a#org_doc_kbis").length){$('<a id="org_doc_kbis" class="button blue-pale download-file" target="_blank" href="'+e.organization.doc_kbis.path+'">'+e.organization.doc_kbis.date_uploaded+"</a><br />").insertBefore($("#wdg-lightbox-editOrga input[name=org_doc_kbis]"))}else $("#wdg-lightbox-editOrga a#org_doc_kbis").attr("href",e.organization.doc_kbis.path),$("#wdg-lightbox-editOrga a#org_doc_kbis").html(e.organization.doc_kbis.date_uploaded);else $("#wdg-lightbox-editOrga a#org_doc_kbis").remove();if(null!=e.organization.doc_status.path)if(0===$("#wdg-lightbox-editOrga a#org_doc_status").length){$('<a id="org_doc_status" class="button blue-pale download-file" target="_blank" href="'+e.organization.doc_status.path+'">'+e.organization.doc_status.date_uploaded+"</a><br />").insertBefore($("#wdg-lightbox-editOrga input[name=org_doc_status]"))}else $("#wdg-lightbox-editOrga a#org_doc_status").attr("href",e.organization.doc_status.path),$("#wdg-lightbox-editOrga a#org_doc_status").html(e.organization.doc_status.date_uploaded);else $("#wdg-lightbox-editOrga a#org_doc_status").remove();if(null!=e.organization.doc_id.path)if(0===$("#wdg-lightbox-editOrga a#org_doc_id").length){$('<a id="org_doc_id" class="button blue-pale download-file" target="_blank" href="'+e.organization.doc_id.path+'">'+e.organization.doc_id.date_uploaded+"</a><br />").insertBefore($("#wdg-lightbox-editOrga input[name=org_doc_id]"))}else $("#wdg-lightbox-editOrga a#org_doc_id").attr("href",e.organization.doc_id.path),$("#wdg-lightbox-editOrga a#org_doc_id").html(e.organization.doc_id.date_uploaded);else $("#wdg-lightbox-editOrga a#org_doc_id").remove();if(null!=e.organization.doc_home.path)if(0===$("#wdg-lightbox-editOrga a#org_doc_home").length){$('<a id="org_doc_home" class="button blue-pale download-file" target="_blank" href="'+e.organization.doc_home.path+'">'+e.organization.doc_home.date_uploaded+"</a><br />").insertBefore($("#wdg-lightbox-editOrga input[name=org_doc_home]"))}else $("#wdg-lightbox-editOrga a#org_doc_home").attr("href",e.organization.doc_home.path),$("#wdg-lightbox-editOrga a#org_doc_home").html(e.organization.doc_home.date_uploaded);else $("#wdg-lightbox-editOrga a#org_doc_home").remove()},WDGCampaignDashboard.prototype.updateOrgaDoc=function(e,a){if(null!==e[a].info)if(0===$("#wdg-lightbox-editOrga a#"+a).length){$('<a id="'+a+'" class="button blue-pale download-file" target="_blank" href="'+e[a].info+'">'+e[a].date+"</a><br />").insertBefore($("#wdg-lightbox-editOrga input[name="+a+"]"))}else $("#wdg-lightbox-editOrga a#"+a).attr("href",e[a].info),$("#wdg-lightbox-editOrga a#"+a).html(e[a].date)},WDGCampaignDashboard.prototype.updateOrgaSelectInput=function(e){var a=e.organization.name,t=e.organization.wpref;$("#orgainfo_form #select-new_project_organization").append(new Option(a,t)),$("#orgainfo_form #select-new_project_organization option:selected").removeAttr("selected"),$("#orgainfo_form #select-new_project_organization option[value="+t+"]").attr("selected","selected")},WDGCampaignDashboard.prototype.getContactsTable=function(e,a){var t=this;t.createTableRequest=$.ajax({type:"POST",url:ajax_object.ajax_url,data:{action:"create_contacts_table",id_campaign:a,data:e}}).done(function(e){t.createTableRequest=void 0,$("#ajax-contacts-load").after(e),$("#ajax-loader-img").hide(),YPUIFunctions.initQtip(),t.table=$("#contacts-table").DataTable({scrollX:"100%",scrollY:"70vh",scrollCollapse:!0,paging:!1,order:[[result_contacts_table.default_sort,"desc"]],colReorder:{fixedColumnsLeft:result_contacts_table.id_column_index+1},fixedColumns:{leftColumns:result_contacts_table.id_column_index+1},columnDefs:[{targets:result_contacts_table.array_hidden,visible:!1},{targets:[result_contacts_table.id_column_index],visible:!1},{className:"select-checkbox",targets:0,orderable:!1},{width:"30px",className:"dt-body-center nopadding",targets:[2,3,4]}],select:{style:"multi",selector:"td:first-child"},dom:"Bfrtip",buttons:[{text:'<i class="fa fa-square-o" aria-hidden="true"></i> Sélectionner les éléments affichés',action:function(){t.table.rows({search:"applied"}).select()}},{extend:"selected",text:'<i class="fa fa-envelope" aria-hidden="true"></i> Envoyer un mail',action:function(e,a,i,n){$("#send-mail-tab").slideDown();$(this).data("target");t.scrollTo($("#send-mail-tab"))}},{extend:"collection",text:'<i class="fa fa-eye" aria-hidden="true"></i> Informations à afficher',buttons:[{extend:"colvis",text:'<i class="fa fa-columns" aria-hidden="true"></i> Colonnes à afficher',columns:":gt("+result_contacts_table.id_column_index+")",collectionLayout:"two-column"},{extend:"colvisGroup",text:"Tout afficher",show:":gt("+result_contacts_table.id_column_index+"):hidden"},{extend:"colvisGroup",text:"Tout masquer",hide:":gt("+result_contacts_table.id_column_index+")"},{extend:"colvisRestore",text:'<i class="fa fa-refresh" aria-hidden="true"></i> Rétablir colonnes par défaut'}]},{extend:"collection",text:'<i class="fa fa-download" aria-hidden="true"></i> Exporter',buttons:[{extend:"excel",text:'<i class="fa fa-file-excel-o" aria-hidden="true"></i> Fichier Excel',exportOptions:{modifier:{columns:":visible"}}},{extend:"print",text:'<i class="fa fa-print" aria-hidden="true"></i> Imprimer',exportOptions:{modifier:{columns:":visible"}}}]}],language:{sProcessing:"Traitement en cours...",sSearch:"Rechercher&nbsp;:",sLengthMenu:"Afficher _MENU_ &eacute;l&eacute;ments",sInfo:"Affichage de _TOTAL_ &eacute;l&eacute;ments",sInfoEmpty:"Aucun &eacute;l&eacute;ment &agrave; afficher",sInfoFiltered:"(filtr&eacute; de _MAX_ &eacute;l&eacute;ments au total)",sInfoPostFix:"",sLoadingRecords:"Chargement en cours...",sZeroRecords:"Aucun &eacute;l&eacute;ment",sEmptyTable:"Aucune donn&eacute;e disponible dans le tableau",oPaginate:{sFirst:"Premier",sPrevious:"Pr&eacute;c&eacute;dent",sNext:"Suivant",sLast:"Dernier"},oAria:{sSortAscending:": activer pour trier la colonne par ordre croissant",sSortDescending:": activer pour trier la colonne par ordre d&eacute;croissant"},select:{rows:{_:"<br /><b>%d</b> contacts sélectionnés",0:"<br />Cliquez sur un contact pour le sélectionner",1:"<br /><b>1</b> contact sélectionné"}}}}),t.table.columns.adjust();var a=t.table.button(1).text();t.table.on("select.dt deselect.dt",function(e,i,n,o){var r=t.table.rows({selected:!0}).count();0==r?(t.table.button(1).text(a),$("#send-mail-tab").slideUp()):t.table.button(1).text(a+" ("+r+")");var d=!0;t.table.rows({search:"applied"}).every(function(e,a,i){-1==$.inArray(e,t.table.rows({selected:!0}).indexes())&&(d=!1)}),d?(t.table.button(0).text('<i class="fa fa-check-square-o" aria-hidden="true"></i> Déselectionner les éléments affichés'),t.table.button(0).action(function(){t.table.rows({search:"applied"}).deselect()})):(t.table.button(0).text('<i class="fa fa-square-o" aria-hidden="true"></i> Sélectionner les éléments affichés'),t.table.button(0).action(function(){t.table.rows({search:"applied"}).select()})),$("#nb-mailed-contacts").text(r);var s=[];$.each(t.table.rows({selected:!0}).data(),function(e,a){s.push(a[result_contacts_table.id_column_index])}),$("#mail_recipients").val(s)}),$(t.table.table().container()).on("keyup","tfoot .text input",function(){t.table.column($(this).data("index")).search(this.value).draw()}),$(t.table.table().container()).on("change","tfoot .check input",function(){$(this).is(":checked")?t.table.column($(this).data("index")).search("1").draw():t.table.column($(this).data("index")).search("").draw()})}).fail(function(){$("#ajax-contacts-load").after("<em>Le chargement du tableau a échoué</em>"),$("#ajax-loader-img").hide()})},WDGCampaignDashboard.prototype.drawTimetable=function(){$("#wdg-timetable tfoot td").each(function(){$(this).prepend('<input type="text" placeholder="Filtrer par :" class="col-filter"/><br/>')}),$("#wdg-timetable tfoot input").on("keyup change",function(){walletTimetable.column($(this).parent().index()+":visible").search(this.value).draw()}),sortColumn=0,this.walletTimetableDatatable=$("#wdg-timetable").DataTable({scrollX:!0,order:[[sortColumn,"asc"]],dom:'RC<"clear">lfrtip',lengthMenu:[[5,10,25,50,100,-1],[5,10,25,50,100,"Tous"]],iDisplayLength:50,colVis:{buttonText:"Afficher/cacher colonnes",restore:"Restaurer",showAll:"Tout afficher",showNone:"Tout cacher",overlayFade:100},language:{sProcessing:"Traitement en cours...",sSearch:"Rechercher&nbsp;:",sLengthMenu:"Afficher _MENU_ &eacute;l&eacute;ments",sInfo:"Affichage de l'&eacute;l&eacute;ment _START_ &agrave; _END_ sur _TOTAL_ &eacute;l&eacute;ments",sInfoEmpty:"Affichage de l'&eacute;l&eacute;ment 0 &agrave; 0 sur 0 &eacute;l&eacute;ments",sInfoFiltered:"(filtr&eacute; de _MAX_ &eacute;l&eacute;ments au total)",sInfoPostFix:"",sLoadingRecords:"Chargement en cours...",sZeroRecords:"Aucun &eacute;l&eacute;ment &agrave; afficher",sEmptyTable:"Aucune donn&eacute;e disponible dans le tableau",oPaginate:{sFirst:"Premier",sPrevious:"Pr&eacute;c&eacute;dent",sNext:"Suivant",sLast:"Dernier"},oAria:{sSortAscending:": activer pour trier la colonne par ordre croissant",sSortDescending:": activer pour trier la colonne par ordre d&eacute;croissant"}}})},WDGCampaignDashboard.prototype.scrollTo=function(e){$("html, body, .wdg-lightbox-padder").animate({scrollTop:e.offset().top-75},"slow")},WDGCampaignDashboard.prototype.fieldError=function(e,a){e.addClass("error"),e.removeClass("validation"),e.qtip({content:a,position:{my:"bottom center",at:"top center"},style:{classes:"wdgQtip qtip-red qtip-rounded qtip-shadow"},show:"focus",hide:"blur"}),e.closest(".field-value").parent().find("i.fa.validation").remove()},WDGCampaignDashboard.prototype.removeFieldError=function(e){e.hasClass("error")&&(e.removeClass("error"),e.qtip().destroy())},WDGCampaignDashboard.prototype.initTeam=function(e){var a=this;$(".project-manage-team").click(function(){var e,t;"yproject-add-member"===(e=$(this).attr("data-action"))?t=$("#new_team_member_string")[0].value:"yproject-remove-member"===e&&(t=$(this).attr("data-user")),a.manageTeam(e,t,campaign_id)})},WDGCampaignDashboard.prototype.initRoyalties=function(){var e=this;if(e.currentOpenedROI=0,$(".transfert-roi-open").length>0&&($(".transfert-roi-open").click(function(){$(this).data("roideclaration-id")!==e.currentOpenedROI&&(e.currentOpenedROI=$(this).data("roideclaration-id"),$("#wdg-lightbox-transfer-roi #lightbox-content .loading-content").html(""),$("#wdg-lightbox-transfer-roi #lightbox-content .loading-image").show(),$("#wdg-lightbox-transfer-roi #lightbox-content .loading-form").hide(),$.ajax({type:"POST",url:ajax_object.ajax_url,data:{action:"display_roi_user_list",roideclaration_id:$(this).data("roideclaration-id")}}).done(function(a){var t="Versement impossible";"0"!=a&&(t="<table>",t+="<tr><td>Utilisateur</td><td>Investissement</td><td>Versement</td><td>Commission</td></tr>",t+=a,t+="</table>",$("#wdg-lightbox-transfer-roi #lightbox-content .loading-form input#hidden-roi-id").val(e.currentOpenedROI),$("#wdg-lightbox-transfer-roi #lightbox-content .loading-form").show()),$("#wdg-lightbox-transfer-roi #lightbox-content .loading-content").html(t),$("#wdg-lightbox-transfer-roi #lightbox-content .loading-image").hide()}))}),$("#proceed_roi_transfers_form").submit(function(a){a.preventDefault(),e.proceedRoyalties()})),$("#turnover-declaration").length>0){$("#turnover-total").length>0&&$("#turnover-total").change(function(){e.refreshTurnoverAmountToPay()});for(var a=0;$("#turnover-"+a).length>0;)$("#turnover-"+a).change(function(){e.refreshTurnoverAmountToPay()}),a++}$("#new_declaration_adjustment_turnover_difference").length>0&&$("#new_declaration_adjustment_turnover_difference").change(function(){e.refreshAjustmentAmountToPay()})},WDGCampaignDashboard.prototype.refreshTurnoverAmountToPay=function(){var e=$("#turnover-declaration").data("roi-percent"),a=$("#turnover-declaration").data("minimum-costs"),t=$("#turnover-declaration").data("costs-orga"),i=0;if($("#turnover-total").length>0)i=Number($("#turnover-total").val().split(",").join("."));else for(var n=0;$("#turnover-"+n).length>0;)i+=Number($("#turnover-"+n).val().split(",").join(".")),n++;var o=i*e/100,r=Math.max(a,o*t/100),d=o+r;d+=$("#turnover-declaration").data("adjustment"),d=Math.round(100*d)/100,$(".amount-to-pay").text(d),$(".commission-to-pay").text(r)},WDGCampaignDashboard.prototype.refreshAjustmentAmountToPay=function(){var e=$("#form-declaration-adjustment").data("roi-percent"),a=($("#form-declaration-adjustment").data("costs-orga"),Number($("#new_declaration_adjustment_turnover_difference").val().split(",").join("."))*e/100);a=Math.round(100*a)/100,$("#new_declaration_adjustment_value").val(a)},WDGCampaignDashboard.prototype.proceedRoyalties=function(){var e=this,a={action:"proceed_roi_transfers",campaign_id:$("#hidden-campaign-id").val(),roi_id:$("#hidden-roi-id").val(),send_notifications:$("#check_send_notifications").is(":checked"),transfer_remaining_amount:$("#check_transfer_remaining_amount").is(":checked")},t=$("#proceed_roi_transfers_button");t.find(".button-text").hide(),t.find(".button-waiting").show(),$.ajax({type:"POST",url:ajax_object.ajax_url,data:a}).done(function(a){if(100==a)$("#proceed_roi_transfers_percent").html("Versement effectu&eacute; !"),$("#proceed_roi_transfers_button").hide();else{var t=parseFloat(a);t=t.toFixed(2),$("#proceed_roi_transfers_percent").html(t+" %"),e.proceedRoyalties()}}).fail(function(){$("#proceed_roi_transfers_percent").html('<span class="error">Erreur serveur (ROI1611)</p>')})},WDGCampaignDashboard.prototype.manageTeam=function(e,a,t){var i=this;"yproject-add-member"===e?""===a||($("#new_team_member_string").prop("disabled",!0),$("#new_team_member_string").val(""),tmpPlaceHolder=$("#new_team_member_string").prop("placeholder"),$("#new_team_member_string").prop("placeholder","Ajout de "+a+"..."),$("#new_team_member_string").next().hide(),$.ajax({type:"POST",url:ajax_object.ajax_url,data:{action:"add_team_member",id_campaign:t,new_team_member:a}}).done(function(n){"FALSE"==n&&alert("Cet utilisateur n'a pas de compte sur la plateforme."),$("#new_team_member_string").prop("disabled",!1),$("#new_team_member_string").prop("placeholder",tmpPlaceHolder),$("#new_team_member_string").next().show(),"FALSE"===n?($("#new_team_member_string").next().next().after('<div id="fail_add_team_indicator"><br/><em>L\'utilisateur '+a+" n'a pas été trouvé</em><div>"),$("#fail_add_team_indicator").delay(4e3).fadeOut(400)):(res=JSON.parse(n),doublon=!1,$(".project-manage-team").each(function(){doublon=doublon||res.id==$(this).attr("data-user")}),doublon||(0==$("#team-list li").length&&$("#team-list").html(""),newline='<li style="display: none;">',newline+=res.firstName+" "+res.lastName+" ("+res.userLink+") ",newline+='<a class="project-manage-team button red" data-action="yproject-remove-member" data-user="'+res.id+'"><i class="fa fa-times fa-fw" aria-hidden="true"></i></a>',newline+="</li>",$("#team-list").append(newline),$("a[data-user="+res.id+"]").closest("li").slideDown(),$("#team-list-empty").hide(),$(".project-manage-team").click(function(){"yproject-add-member"===(e=$(this).attr("data-action"))?a=$("#new_team_member_string")[0].value:"yproject-remove-member"===e&&(a=$(this).attr("data-user")),i.manageTeam(e,a,t)})))})):"yproject-remove-member"===e&&($("a[data-user="+a+"]").closest("li").css("opacity",.5),$("a[data-user="+a+"]").html('<i class="fa fa-spinner fa-spin fa-fw"></i>'),$.ajax({type:"POST",url:ajax_object.ajax_url,data:{action:"remove_team_member",id_campaign:t,user_to_remove:a}}).done(function(e){$("a[data-user="+a+"]").closest("li").slideUp("slow",function(){$(this).remove()})}))},WDGCampaignDashboard.prototype.initFinance=function(){$("#new_first_payment").change(function(){$("#estimated-turnover tr .year").each(function(e){$(this).html(parseInt(1)+e)})}),$("#select-new_funding_duration").change(function(){var e=$("#estimated-turnover tr").length,a=parseInt($("#select-new_funding_duration").val());if(0==a&&(a=5),a>e){var t=$("#estimated-turnover").html();if(a<=20)for(var i=0;i<a-e;i++)t=t+'<tr><td>Année&nbsp;<span class="year">'+(i+1+e)+'</span></td><td class="field field-value" data-type="number" data-id="new_estimated_turnover_'+(i+e)+'"><i class="right fa" aria-hidden="true"></i><input type="number" value="0" id="new_estimated_turnover_'+(i+e)+'" class="right-icon format-number" />&nbsp;'+$("#estimated-turnover").data("symbol")+'</td><td id="roi-amount-'+(i+e)+'">0 '+$("#estimated-turnover").data("symbol")+"</td></tr>";$("#estimated-turnover").html(t),$("#new_first_payment").trigger("change"),e=a}else $("#estimated-turnover tr").hide(),$("#estimated-turnover tr").slice(0,a).show();e=Math.max(a,e),wdgCampaignSimulator.calculAndShowResult()}),$("#select-new_funding_duration").trigger("change"),$("#select-new_funding_duration").keyup(function(){""!==$("#select-new_funding_duration").val()&&$("#select-new_funding_duration").trigger("change")}),$("#new_maximum_goal, #new_roi_percent_estimated, #select-new_funding_duration").bind("keyup click",function(){wdgCampaignSimulator.attachEventOnCa(),""!==$("#new_maximum_goal").val()&&""!==$("#new_minimum_goal").val()&&""!==$("#select-new_funding_duration").val()&&""!==$("#new_roi_percent_estimated").val()?wdgCampaignSimulator.calculAndShowResult():wdgCampaignSimulator.initResultCalcul()})},WDGCampaignDashboard.prototype.initCampaign=function(){$("#item-body-campaign ul input[type=checkbox]").prop("disabled",!1)};var wdgCampaignDashboard;jQuery(document).ready(function(e){e("ul.nav-menu").length>0&&(wdgCampaignDashboard=new WDGCampaignDashboard)});